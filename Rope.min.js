var j=null,k,m;function n(e,f){return function(){return e.apply(f,arguments)}}m=function(){var e;for(e=1;Math.random()>0.7;)e++;return e};module.exports=k=function(e){if(!(this instanceof k))return new k(e);this.d={a:[],c:[]};this.length=0;e!=j&&this.insert(0,e);return this};k.prototype.each=function(e){var f,a;f=this.d.a[0];for(a=[];f!=j;)e(f.b),a.push(f=f.a[0]);return a};k.prototype.toString=function(){var e;e=[];this.each(function(f){return e.push(f)});return e.join("")};
k.prototype.insert=function(e,f){var a,b,g,h,c,i,l;if(typeof e!=="number")throw Error("pos must be a number");if(!(0<=e&&e<=this.length))throw Error("pos must be within the rope ("+this.length+")");if(typeof f!=="string")throw Error("inserted text must be a string");a=this.d;h=Array(this.d.a.length);i=Array(this.d.a.length);c=e;if(a.a.length>0)for(g=l=this.d.a.length-1;l<=0?g<=0:g>=0;l<=0?g+=1:g-=1){for(;c>a.c[g];)c-=a.c[g],a=a.a[g];i[g]=c;h[g]=a}l=function(a){var b,d,e;e=[];b=0;for(d=h.length;0<=
d?b<d:b>d;0<=d?b+=1:b-=1)e.push(h[b].c[b]+=a)};if(a.b!=j&&a.b.length+f.length<512)a.b=a.b.slice(0,c)+f+a.b.slice(c),l(f.length),this.length+=f.length;else{g=n(function(a){var b,d,c;b=m();c={b:a,a:Array(b),c:Array(b)};for(d=0;0<=b?d<b:d>b;0<=b?d+=1:d-=1)d<this.d.a.length?(c.a[d]=h[d].a[d],h[d].a[d]=c,c.c[d]=a.length+h[d].c[d]-i[d],h[d].c[d]=i[d]):(c.a[d]=j,c.c[d]=this.length-e+a.length,this.d.a.push(c),this.d.c.push(e)),h[d]=c,i[d]=a.length;if(b<h.length){d=b;for(c=h.length;b<=c?d<c:d>c;b<=c?d+=1:
d-=1)h[d].c[d]+=a.length,i[d]+=a.length}e+=a.length;this.length+=a.length;if(k.e)return this.print()},this);if(a.b!=j&&a.b.length>c)b=a.b.slice(c),a.b=a.b.slice(0,c),l(-b.length),this.length-=b.length,k.e&&this.print();a=0;for(c=f.length;0<=c?a<c:a>c;a+=512)g(f.slice(a,a+512));b!=j&&g(b)}return this};
k.prototype.del=function(e,f){var a,b,g,h,c,i;if(typeof e!=="number")throw Error("pos must be a number");if(!(0<=e&&e<=this.length))throw Error("pos "+e+" must be within the rope ("+this.length+")");if(!(0<=(a=e+f)&&a<=this.length))throw Error("pos "+(e+f)+" must be within the rope ("+this.length+")");a=this.d;g=Array(this.d.a.length);k.e&&this.print();h=e;if(a.a.length>0)for(b=c=a.a.length-1;c<=0?b<=0:b>=0;c<=0?b+=1:b-=1){for(;h>a.c[b];)h-=a.c[b],a=a.a[b];g[b]=a}for(this.length-=f;f>0;){if(a.b==
j||h===a.b.length)a=g[0].a[0],h=0;c=Math.min(f,a.b.length-h);if(c<a.b.length){a.b=a.b.slice(0,h)+a.b.slice(h+c);b=0;for(i=g.length;0<=i?b<i:b>i;0<=i?b+=1:b-=1)b<a.a.length?a.c[b]-=c:g[b].c[b]-=c}else{b=0;for(i=g.length;0<=i?b<i:b>i;0<=i?b+=1:b-=1)b<a.a.length?(g[b].c[b]=g[b].c[b]+a.c[b]-c,g[b].a[b]=a.a[b]):g[b].c[b]-=c;a=a.a[0]}f-=c}return this};