var k=null,l,m;function n(c,g){return function(){return c.apply(g,arguments)}}m=function(){var c;for(c=1;Math.random()>0.7;)c++;return c};module.exports=l=function(c){if(!(this instanceof l))return new l(c);this.d={a:[],c:[]};this.length=0;c!=k&&this.insert(0,c);return this};l.prototype.each=function(c){var g,d;g=this.d.a[0];for(d=[];g!=k;)c(g.b),d.push(g=g.a[0]);return d};l.prototype.toString=function(){var c;c=[];this.each(function(g){return c.push(g)});return c.join("")};
l.prototype.insert=function(c,g){var d,b,a,h,f,j,i;if(typeof c!=="number")throw Error("pos must be a number");if(!(0<=c&&c<=this.length))throw Error("pos must be within the rope ("+this.length+")");if(typeof g!=="string")throw Error("inserted text must be a string");d=this.d;h=Array(this.d.a.length);j=Array(this.d.a.length);f=c;if(d.a.length>0)for(a=i=this.d.a.length-1;i<=0?a<=0:a>=0;i<=0?a+=1:a-=1){for(;f>d.c[a];)f-=d.c[a],d=d.a[a];j[a]=f;h[a]=d}i=function(a){var c,e,b;b=[];c=0;for(e=h.length;0<=
e?c<e:c>e;0<=e?c+=1:c-=1)b.push(h[c].c[c]+=a)};if(d.b!=k&&d.b.length+g.length<512)d.b=d.b.slice(0,f)+g+d.b.slice(f),i(g.length),this.length+=g.length;else{a=n(function(a){var b,e,d;b=m();d={b:a,a:Array(b),c:Array(b)};for(e=0;0<=b?e<b:e>b;0<=b?e+=1:e-=1)e<this.d.a.length?(d.a[e]=h[e].a[e],h[e].a[e]=d,d.c[e]=a.length+h[e].c[e]-j[e],h[e].c[e]=j[e]):(d.a[e]=k,d.c[e]=this.length-c+a.length,this.d.a.push(d),this.d.c.push(c)),h[e]=d,j[e]=a.length;if(b<h.length){e=b;for(d=h.length;b<=d?e<d:e>d;b<=d?e+=1:
e-=1)h[e].c[e]+=a.length,j[e]+=a.length}c+=a.length;this.length+=a.length;if(l.e)return this.print()},this);if(d.b!=k&&d.b.length>f)b=d.b.slice(f),d.b=d.b.slice(0,f),i(-b.length),this.length-=b.length,l.e&&this.print();d=0;for(f=g.length;0<=f?d<f:d>f;d+=512)a(g.slice(d,d+512));b!=k&&a(b)}return this};
l.prototype.del=function(c,g,d){var b,a,h,f,j,i;if(typeof c!=="number")throw Error("pos must be a number");if(!(0<=c&&c<=this.length))throw Error("pos "+c+" must be within the rope ("+this.length+")");if(!(0<=(b=c+g)&&b<=this.length))throw Error("pos "+(c+g)+" must be within the rope ("+this.length+")");b=this.d;h=Array(this.d.a.length);d!=k&&(j=[]);l.e&&this.print();if(b.a.length>0)for(a=f=b.a.length-1;f<=0?a<=0:a>=0;f<=0?a+=1:a-=1){for(;c>b.c[a];)c-=b.c[a],b=b.a[a];h[a]=b}for(this.length-=g;g>0;){if(b.b==
k||c===b.b.length)b=h[0].a[0],c=0;f=Math.min(g,b.b.length-c);if(f<b.b.length){j!=k&&j.push(b.b.slice(c,c+f));b.b=b.b.slice(0,c)+b.b.slice(c+f);a=0;for(i=h.length;0<=i?a<i:a>i;0<=i?a+=1:a-=1)a<b.a.length?b.c[a]-=f:h[a].c[a]-=f}else{d!=k&&j.push(b.b);a=0;for(i=h.length;0<=i?a<i:a>i;0<=i?a+=1:a-=1)a<b.a.length?(h[a].c[a]=h[a].c[a]+b.c[a]-f,h[a].a[a]=b.a[a]):h[a].c[a]-=f;b=b.a[0]}g-=f}d!=k&&d(j.join(""));return this};